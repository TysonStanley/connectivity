---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# connectivity

The goal of connectivity is to make the importing, cleaning, and analyzing of NIRS data recipe based. That is, piping three main functions will lead from import to analysis with minimal effort of the user.

## Installation

You can install the GitHub version of `connectivity` with:

``` r
remotes::install_github("tysonstanley/connectivity")
```

## Example

The receipe is as follows:

1. Import and Clean
2. Analyze
3. Visualize

The `import_nirs()` function depends on a files structure that looks something like:

```{r, echo = FALSE, eval = FALSE}
## quick-and-dirty ersatz Unix tree command in R
## inspired by this one-liner:
## ls -R | grep ":$" | sed -e 's/:$//' -e 's/[^-][^\/]*\//--/g' -e 's/^/   /' -e 's/-/|/'
## found here (among many other places):
## http://serverfault.com/questions/143954/how-to-generate-an-ascii-representation-of-a-unix-file-hierarchy

twee <- function(path = getwd(), level = Inf) {
  
  fad <-
    list.files(path = path, recursive = TRUE,no.. = TRUE, include.dirs = TRUE)

  fad_split_up <- strsplit(fad, "/")

  too_deep <- lapply(fad_split_up, length) > level
  fad_split_up[too_deep] <- NULL
  
  jfun <- function(x) {
    n <- length(x)
    if(n > 1)
      x[n - 1] <- "|__"
    if(n > 2)
      x[1:(n - 2)] <- "   "
    x <- if(n == 1) c("-- ", x) else c("   ", x)
    x
  }
  fad_subbed_out <- lapply(fad_split_up, jfun)
  
  cat(unlist(lapply(fad_subbed_out, paste, collapse = "")), sep = "\n")
}
twee("~/Box/Stuttering Writing Group/PhoneCallsStutter/", level = 2)
```
```
-- P07
   |__P07_brodExtract.csv
   |__P07_HBA_Probe1_Deoxy.csv
   |__P07_HBA_Probe1_Oxy.csv
   |__P07_HBA_Probe1_Total.csv
   |__P07_HBA_Probe2_Deoxy.csv
   |__P07_HBA_Probe2_Oxy.csv
   |__P07_HBA_Probe2_Total.csv
-- P08
   |__P08_brodExtract.csv
   |__P08_HBA_Probe1_Deoxy.csv
   |__P08_HBA_Probe1_Oxy.csv
   |__P08_HBA_Probe1_Total.csv
   |__P08_HBA_Probe2_Deoxy.csv
   |__P08_HBA_Probe2_Oxy.csv
   |__P08_HBA_Probe2_Total.csv
-- P09
   |__P09_brodExtract.csv
   |__P09_HBA_Probe1_Deoxy.csv
   |__P09_HBA_Probe1_Oxy.csv
   |__P09_HBA_Probe1_Total.csv
   |__...
```   

where each participant has its own folder with the data within that folder.

In our data (not currently provided), we have 5 regions that we are interested in that are mapped out in the `*brod.csv` files. To inform on what region goes with which channel from the Probe files, we use the import function like so:

```{r, message = FALSE, warning = FALSE, eval = FALSE}
## Superior Temporal Gyrus (STG),
## Inferior Parietal Lobule (made up of Supramarginal Gyrus and Angular Gyrus),
## Inferior frontal Gyrus (IFG),
## Supplementary Motor Association (SMA) and
## the Motor Cortex (M1)
path <- "~/Box/Stuttering Writing Group/PhoneCallsStutter/"
data <- import_nirs(path,
                    stg = 22, ipl = c(39, 40), ifg = c(44, 45), sma = 6, pmc = 4)
```

The `stg = 22, ipl = c(30, 40), ...` correspond to regions (the name) and their number in the `*brod.csv` file. This creates a nested tibble called `data` that looks like this:

```{r, eval = FALSE}
data
```

